# THIáº¾T Káº¾ KIáº¾N TRÃšC Há»† THá»NG - NHH-COFFEE

## ğŸ“‹ Má»¤C Lá»¤C

1. [Tá»•ng quan kiáº¿n trÃºc](#1-tá»•ng-quan-kiáº¿n-trÃºc)
2. [Kiáº¿n trÃºc tá»•ng thá»ƒ](#2-kiáº¿n-trÃºc-tá»•ng-thá»ƒ)
3. [Kiáº¿n trÃºc phÃ¢n lá»›p](#3-kiáº¿n-trÃºc-phÃ¢n-lá»›p)
4. [Kiáº¿n trÃºc triá»ƒn khai](#4-kiáº¿n-trÃºc-triá»ƒn-khai)
5. [Kiáº¿n trÃºc dá»¯ liá»‡u](#5-kiáº¿n-trÃºc-dá»¯-liá»‡u)
6. [Kiáº¿n trÃºc báº£o máº­t](#6-kiáº¿n-trÃºc-báº£o-máº­t)
7. [Kiáº¿n trÃºc tÃ­ch há»£p](#7-kiáº¿n-trÃºc-tÃ­ch-há»£p)
8. [Thiáº¿t káº¿ API](#8-thiáº¿t-káº¿-api)
9. [Thiáº¿t káº¿ Real-time](#9-thiáº¿t-káº¿-real-time)
10. [Chiáº¿n lÆ°á»£c má»Ÿ rá»™ng](#10-chiáº¿n-lÆ°á»£c-má»Ÿ-rá»™ng)

---

## 1. Tá»”NG QUAN KIáº¾N TRÃšC

### 1.1 MÃ´ hÃ¬nh kiáº¿n trÃºc

Há»‡ thá»‘ng NHH-Coffee sá»­ dá»¥ng **kiáº¿n trÃºc Client-Server** káº¿t há»£p vá»›i **Layered Architecture** (kiáº¿n trÃºc phÃ¢n lá»›p) vÃ  **Microservices-ready** Ä‘á»ƒ Ä‘áº£m báº£o:

- **TÃ¡ch biá»‡t rÃµ rÃ ng**: Frontend vÃ  Backend Ä‘á»™c láº­p
- **Dá»… báº£o trÃ¬**: Má»—i lá»›p cÃ³ trÃ¡ch nhiá»‡m riÃªng
- **Kháº£ nÄƒng má»Ÿ rá»™ng**: CÃ³ thá»ƒ scale tá»«ng pháº§n Ä‘á»™c láº­p
- **TÃ¡i sá»­ dá»¥ng**: Code cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng giá»¯a cÃ¡c module

### 1.2 NguyÃªn táº¯c thiáº¿t káº¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NGUYÃŠN Táº®C THIáº¾T Káº¾                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. SEPARATION OF CONCERNS (TÃ¡ch biá»‡t trÃ¡ch nhiá»‡m)              â”‚
â”‚     - Frontend: UI/UX, State Management                         â”‚
â”‚     - Backend: Business Logic, Data Access                      â”‚
â”‚     - Database: Data Storage                                    â”‚
â”‚                                                                  â”‚
â”‚  2. SINGLE RESPONSIBILITY (TrÃ¡ch nhiá»‡m Ä‘Æ¡n nháº¥t)                â”‚
â”‚     - Má»—i module/class chá»‰ lÃ m má»™t viá»‡c                         â”‚
â”‚     - Dá»… test, dá»… maintain                                      â”‚
â”‚                                                                  â”‚
â”‚  3. DRY (Don't Repeat Yourself)                                 â”‚
â”‚     - TÃ¡i sá»­ dá»¥ng code thÃ´ng qua services, utilities            â”‚
â”‚     - Shared types, interfaces                                  â”‚
â”‚                                                                  â”‚
â”‚  4. SOLID PRINCIPLES                                            â”‚
â”‚     - Single Responsibility                                     â”‚
â”‚     - Open/Closed                                               â”‚
â”‚     - Liskov Substitution                                       â”‚
â”‚     - Interface Segregation                                     â”‚
â”‚     - Dependency Inversion                                      â”‚
â”‚                                                                  â”‚
â”‚  5. SCALABILITY (Kháº£ nÄƒng má»Ÿ rá»™ng)                              â”‚
â”‚     - Horizontal scaling: ThÃªm server                           â”‚
â”‚     - Vertical scaling: NÃ¢ng cáº¥p pháº§n cá»©ng                      â”‚
â”‚     - Caching: Redis                                            â”‚
â”‚                                                                  â”‚
â”‚  6. SECURITY FIRST (Báº£o máº­t Æ°u tiÃªn)                            â”‚
â”‚     - Authentication: JWT                                       â”‚
â”‚     - Authorization: Role-based                                 â”‚
â”‚     - Input validation                                          â”‚
â”‚     - SQL injection prevention                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 CÃ´ng nghá»‡ sá»­ dá»¥ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TECHNOLOGY STACK                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  FRONTEND                                                        â”‚
â”‚  â”œâ”€ Framework: Next.js 16 (React 19)                            â”‚
â”‚  â”œâ”€ Language: TypeScript                                        â”‚
â”‚  â”œâ”€ UI Library: Radix UI + Tailwind CSS                         â”‚
â”‚  â”œâ”€ State: React Context API                                    â”‚
â”‚  â”œâ”€ Forms: React Hook Form + Zod                                â”‚
â”‚  â”œâ”€ Charts: Recharts                                            â”‚
â”‚  â””â”€ Real-time: Socket.io Client                                 â”‚
â”‚                                                                  â”‚
â”‚  BACKEND                                                         â”‚
â”‚  â”œâ”€ Runtime: Node.js                                            â”‚
â”‚  â”œâ”€ Framework: Express.js                                       â”‚
â”‚  â”œâ”€ Language: TypeScript                                        â”‚
â”‚  â”œâ”€ ORM: Prisma                                                 â”‚
â”‚  â”œâ”€ Validation: Zod                                             â”‚
â”‚  â”œâ”€ Authentication: JWT                                         â”‚
â”‚  â”œâ”€ Real-time: Socket.io                                        â”‚
â”‚  â””â”€ API Docs: Swagger                                           â”‚
â”‚                                                                  â”‚
â”‚  DATABASE & STORAGE                                             â”‚
â”‚  â”œâ”€ Database: PostgreSQL                                        â”‚
â”‚  â”œâ”€ Cache: Redis (with Memory fallback)                         â”‚
â”‚  â”œâ”€ File Storage: Cloudinary                                    â”‚
â”‚  â””â”€ Session: In-memory (Socket.io)                              â”‚
â”‚                                                                  â”‚
â”‚  EXTERNAL SERVICES                                              â”‚
â”‚  â”œâ”€ AI: Google Gemini                                           â”‚
â”‚  â”œâ”€ Email: Nodemailer (SMTP)                                    â”‚
â”‚  â”œâ”€ Push: Web Push API                                          â”‚
â”‚  â””â”€ Payment: VietQR                                             â”‚
â”‚                                                                  â”‚
â”‚  DEVOPS & TOOLS                                                 â”‚
â”‚  â”œâ”€ Version Control: Git                                        â”‚
â”‚  â”œâ”€ Package Manager: npm                                        â”‚
â”‚  â”œâ”€ Testing: Vitest                                             â”‚
â”‚  â”œâ”€ Linting: ESLint                                             â”‚
â”‚  â””â”€ Process Manager: PM2 (production)                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. KIáº¾N TRÃšC Tá»”NG THá»‚

### 2.1 SÆ¡ Ä‘á»“ kiáº¿n trÃºc tá»•ng thá»ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT TIER                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    WEB BROWSERS                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚   Chrome     â”‚  â”‚   Firefox    â”‚  â”‚    Safari    â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ HTTPS / WebSocket
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PRESENTATION TIER                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Next.js Application                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚    Pages     â”‚  â”‚  Components  â”‚  â”‚   Contexts   â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚    Hooks     â”‚  â”‚  API Client  â”‚  â”‚    Utils     â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ HTTP REST API / WebSocket
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       APPLICATION TIER                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Express.js Server                              â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  API GATEWAY                                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - CORS, Security Headers, Rate Limiting                   â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  MIDDLEWARE LAYER                                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Authentication (JWT)                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Authorization (Role-based)                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Validation (Zod)                                        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  CONTROLLER LAYER                                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Auth, Products, Orders, Cart, Chat, etc.                â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  SERVICE LAYER                                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Business Logic                                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Cache, Email, Chatbot, Push, Notification               â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  DATA ACCESS LAYER                                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Prisma ORM                                              â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  SOCKET.IO SERVER                                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Real-time Communication                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Chat, Notifications, Kitchen Updates                    â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ SQL / Cache Protocol
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          DATA TIER                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚  PostgreSQL  â”‚  â”‚    Redis     â”‚  â”‚  Cloudinary  â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  (Primary)   â”‚  â”‚   (Cache)    â”‚  â”‚   (Images)   â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ API Calls
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EXTERNAL SERVICES                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚  Google AI   â”‚  â”‚  SMTP Server â”‚  â”‚   VietQR     â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  (Gemini)    â”‚  â”‚   (Email)    â”‚  â”‚  (Payment)   â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Luá»“ng dá»¯ liá»‡u chÃ­nh

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LUá»’NG Dá»® LIá»†U REQUEST                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Browser
    â”‚
    â”‚ 1. HTTP Request
    â–¼
Next.js (SSR/CSR)
    â”‚
    â”‚ 2. API Call
    â–¼
Express API Gateway
    â”‚
    â”‚ 3. Security Check
    â”œâ”€ CORS
    â”œâ”€ Rate Limiting
    â””â”€ Security Headers
    â”‚
    â–¼
Authentication Middleware
    â”‚
    â”‚ 4. Verify JWT Token
    â”œâ”€ Valid â†’ Continue
    â””â”€ Invalid â†’ 401 Unauthorized
    â”‚
    â–¼
Authorization Middleware
    â”‚
    â”‚ 5. Check Role Permission
    â”œâ”€ Authorized â†’ Continue
    â””â”€ Forbidden â†’ 403 Forbidden
    â”‚
    â–¼
Validation Middleware
    â”‚
    â”‚ 6. Validate Input (Zod)
    â”œâ”€ Valid â†’ Continue
    â””â”€ Invalid â†’ 400 Bad Request
    â”‚
    â–¼
Controller
    â”‚
    â”‚ 7. Handle Request
    â–¼
Service Layer
    â”‚
    â”‚ 8. Business Logic
    â”œâ”€ Check Cache (Redis)
    â”œâ”€ Process Data
    â””â”€ Call External APIs
    â”‚
    â–¼
Data Access Layer (Prisma)
    â”‚
    â”‚ 9. Database Query
    â–¼
PostgreSQL
    â”‚
    â”‚ 10. Return Data
    â–¼
Service Layer
    â”‚
    â”‚ 11. Transform Data
    â”‚ 12. Update Cache
    â–¼
Controller
    â”‚
    â”‚ 13. Format Response
    â–¼
Express Response
    â”‚
    â”‚ 14. HTTP Response
    â–¼
Next.js
    â”‚
    â”‚ 15. Update UI
    â–¼
User Browser
```

---

## 3. KIáº¾N TRÃšC PHÃ‚N Lá»šP

### 3.1 SÆ¡ Ä‘á»“ phÃ¢n lá»›p chi tiáº¿t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRESENTATION LAYER                            â”‚
â”‚                     (Client-side)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Pages (Next.js App Router)                                â”‚ â”‚
â”‚  â”‚  - app/page.tsx (Home)                                     â”‚ â”‚
â”‚  â”‚  - app/products/page.tsx                                   â”‚ â”‚
â”‚  â”‚  - app/cart/page.tsx                                       â”‚ â”‚
â”‚  â”‚  - app/staff/*/page.tsx                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Components                                                â”‚ â”‚
â”‚  â”‚  - UI Components (Radix UI)                                â”‚ â”‚
â”‚  â”‚  - Feature Components                                      â”‚ â”‚
â”‚  â”‚  - Layout Components                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  State Management (React Context)                          â”‚ â”‚
â”‚  â”‚  - AuthContext                                             â”‚ â”‚
â”‚  â”‚  - CartContext                                             â”‚ â”‚
â”‚  â”‚  - WishlistContext                                         â”‚ â”‚
â”‚  â”‚  - ChatContext                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  API Client Layer                                          â”‚ â”‚
â”‚  â”‚  - HTTP Client (Fetch API)                                 â”‚ â”‚
â”‚  â”‚  - WebSocket Client (Socket.io)                            â”‚ â”‚
â”‚  â”‚  - Request/Response Interceptors                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚ HTTP/WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API GATEWAY LAYER                            â”‚
â”‚                      (Server-side)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Security Middleware                                       â”‚ â”‚
â”‚  â”‚  - CORS Configuration                                      â”‚ â”‚
â”‚  â”‚  - Helmet (Security Headers)                               â”‚ â”‚
â”‚  â”‚  - Rate Limiting                                           â”‚ â”‚
â”‚  â”‚  - CSRF Protection                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Authentication & Authorization                            â”‚ â”‚
â”‚  â”‚  - JWT Verification                                        â”‚ â”‚
â”‚  â”‚  - Role-based Access Control                               â”‚ â”‚
â”‚  â”‚  - Permission Checking                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Validation Layer                                          â”‚ â”‚
â”‚  â”‚  - Input Validation (Zod)                                  â”‚ â”‚
â”‚  â”‚  - Schema Validation                                       â”‚ â”‚
â”‚  â”‚  - Sanitization                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CONTROLLER LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Route Controllers                                         â”‚ â”‚
â”‚  â”‚  - AuthController                                          â”‚ â”‚
â”‚  â”‚  - ProductController                                       â”‚ â”‚
â”‚  â”‚  - OrderController                                         â”‚ â”‚
â”‚  â”‚  - CartController                                          â”‚ â”‚
â”‚  â”‚  - ChatbotController                                       â”‚ â”‚
â”‚  â”‚  - POSController                                           â”‚ â”‚
â”‚  â”‚  - TableController                                         â”‚ â”‚
â”‚  â”‚  - KitchenController                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚  Responsibilities:                                              â”‚
â”‚  - Handle HTTP Requests                                         â”‚
â”‚  - Call Service Layer                                           â”‚
â”‚  - Format Responses                                             â”‚
â”‚  - Error Handling                                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SERVICE LAYER                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Business Logic Services                                   â”‚ â”‚
â”‚  â”‚  - CacheService (Redis + Memory)                           â”‚ â”‚
â”‚  â”‚  - EmailService (Nodemailer)                               â”‚ â”‚
â”‚  â”‚  - ChatbotService (AI Integration)                         â”‚ â”‚
â”‚  â”‚  - GeminiService (Google AI)                               â”‚ â”‚
â”‚  â”‚  - NotificationService (Socket.io)                         â”‚ â”‚
â”‚  â”‚  - PushService (Web Push)                                  â”‚ â”‚
â”‚  â”‚  - ShippingService                                         â”‚ â”‚
â”‚  â”‚  - WishlistSaleService                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚  Responsibilities:                                              â”‚
â”‚  - Business Rules Implementation                                â”‚
â”‚  - Data Transformation                                          â”‚
â”‚  - External API Integration                                     â”‚
â”‚  - Caching Strategy                                             â”‚
â”‚  - Transaction Management                                       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DATA ACCESS LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Prisma ORM                                                â”‚ â”‚
â”‚  â”‚  - Schema Definition                                       â”‚ â”‚
â”‚  â”‚  - Query Builder                                           â”‚ â”‚
â”‚  â”‚  - Migration Management                                    â”‚ â”‚
â”‚  â”‚  - Type Safety                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚  Responsibilities:                                              â”‚
â”‚  - Database Queries                                             â”‚
â”‚  - Data Mapping                                                 â”‚
â”‚  - Connection Pooling                                           â”‚
â”‚  - Transaction Handling                                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATABASE LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  PostgreSQL Database                                       â”‚ â”‚
â”‚  â”‚  - Tables & Relationships                                  â”‚ â”‚
â”‚  â”‚  - Indexes & Constraints                                   â”‚ â”‚
â”‚  â”‚  - Stored Procedures                                       â”‚ â”‚
â”‚  â”‚  - Triggers                                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


### 3.2 TrÃ¡ch nhiá»‡m tá»«ng lá»›p

| Lá»›p | TrÃ¡ch nhiá»‡m | CÃ´ng nghá»‡ |
|-----|-------------|-----------|
| **Presentation** | - Hiá»ƒn thá»‹ UI<br>- Xá»­ lÃ½ user input<br>- State management<br>- Routing | Next.js, React, Tailwind CSS |
| **API Gateway** | - Security<br>- Authentication<br>- Rate limiting<br>- Request validation | Express middleware, Helmet, JWT |
| **Controller** | - Handle requests<br>- Call services<br>- Format responses<br>- Error handling | Express routes |
| **Service** | - Business logic<br>- Data transformation<br>- External integrations<br>- Caching | TypeScript classes |
| **Data Access** | - Database queries<br>- Data mapping<br>- Transactions | Prisma ORM |
| **Database** | - Data storage<br>- Data integrity<br>- Indexing | PostgreSQL |

---

## 4. KIáº¾N TRÃšC TRIá»‚N KHAI

### 4.1 MÃ´i trÆ°á»ng Development

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DEVELOPMENT ENVIRONMENT (localhost)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Developer Machine                                         â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚  Next.js Dev     â”‚         â”‚  Express Dev     â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  Port: 3000      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Port: 3001      â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  - Hot Reload    â”‚         â”‚  - tsx watch     â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  - Fast Refresh  â”‚         â”‚  - Auto restart  â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â”‚                                         â”‚                   â”‚ â”‚
â”‚  â”‚                                         â–¼                   â”‚ â”‚
â”‚  â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â”‚
â”‚  â”‚                              â”‚  PostgreSQL      â”‚           â”‚ â”‚
â”‚  â”‚                              â”‚  Port: 5432      â”‚           â”‚ â”‚
â”‚  â”‚                              â”‚  - Local DB      â”‚           â”‚ â”‚
â”‚  â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”‚
â”‚  â”‚                                         â”‚                   â”‚ â”‚
â”‚  â”‚                                         â–¼                   â”‚ â”‚
â”‚  â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â”‚
â”‚  â”‚                              â”‚  Redis           â”‚           â”‚ â”‚
â”‚  â”‚                              â”‚  Port: 6379      â”‚           â”‚ â”‚
â”‚  â”‚                              â”‚  (Optional)      â”‚           â”‚ â”‚
â”‚  â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  Tools:                                                          â”‚
â”‚  - VS Code / IDE                                                 â”‚
â”‚  - Git                                                           â”‚
â”‚  - npm / pnpm                                                    â”‚
â”‚  - Prisma Studio                                                 â”‚
â”‚  - Postman / Thunder Client                                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 MÃ´i trÆ°á»ng Production (VPS)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRODUCTION ENVIRONMENT                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                         â”‚   Internet   â”‚                        â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                â”‚                                 â”‚
â”‚                                â–¼                                 â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                    â”‚  Domain + SSL     â”‚                        â”‚
â”‚                    â”‚  (Let's Encrypt)  â”‚                        â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                             â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  VPS Server (Ubuntu 22.04)                              â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  Nginx (Reverse Proxy)                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Port: 80, 443                                     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  - SSL/TLS Termination                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  - Load Balancing                                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  - Static File Serving                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  - Gzip Compression                                â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚           â”‚                       â”‚                      â”‚   â”‚
â”‚  â”‚           â–¼                       â–¼                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚  â”‚  Next.js       â”‚     â”‚  Express API   â”‚             â”‚   â”‚
â”‚  â”‚  â”‚  (PM2)         â”‚     â”‚  (PM2)         â”‚             â”‚   â”‚
â”‚  â”‚  â”‚  Port: 3000    â”‚     â”‚  Port: 3001    â”‚             â”‚   â”‚
â”‚  â”‚  â”‚  - 2 instances â”‚     â”‚  - 4 instances â”‚             â”‚   â”‚
â”‚  â”‚  â”‚  - Cluster modeâ”‚     â”‚  - Cluster modeâ”‚             â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â”‚                                   â”‚                      â”‚   â”‚
â”‚  â”‚                                   â–¼                      â”‚   â”‚
â”‚  â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚                        â”‚  PostgreSQL      â”‚             â”‚   â”‚
â”‚  â”‚                        â”‚  Port: 5432      â”‚             â”‚   â”‚
â”‚  â”‚                        â”‚  - Master DB     â”‚             â”‚   â”‚
â”‚  â”‚                        â”‚  - Auto backup   â”‚             â”‚   â”‚
â”‚  â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â”‚                                   â”‚                      â”‚   â”‚
â”‚  â”‚                                   â–¼                      â”‚   â”‚
â”‚  â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚                        â”‚  Redis           â”‚             â”‚   â”‚
â”‚  â”‚                        â”‚  Port: 6379      â”‚             â”‚   â”‚
â”‚  â”‚                        â”‚  - Cache layer   â”‚             â”‚   â”‚
â”‚  â”‚                        â”‚  - Session store â”‚             â”‚   â”‚
â”‚  â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  PM2 Process Manager                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  - Auto restart on crash                           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  - Log management                                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  - Monitoring                                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  - Load balancing                                  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  System Resources:                                       â”‚   â”‚
â”‚  â”‚  - CPU: 4 cores                                          â”‚   â”‚
â”‚  â”‚  - RAM: 8GB                                              â”‚   â”‚
â”‚  â”‚  - Storage: 100GB SSD                                    â”‚   â”‚
â”‚  â”‚  - Bandwidth: 1TB/month                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EXTERNAL SERVICES                           â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Cloudinary  â”‚  â”‚  Google AI   â”‚  â”‚  SMTP Server â”‚         â”‚
â”‚  â”‚  (CDN)       â”‚  â”‚  (Gemini)    â”‚  â”‚  (Email)     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 Cáº¥u hÃ¬nh Nginx

```nginx
# /etc/nginx/sites-available/nhh-coffee

upstream nextjs_upstream {
    server 127.0.0.1:3000;
    keepalive 64;
}

upstream api_upstream {
    server 127.0.0.1:3001;
    keepalive 64;
}

server {
    listen 80;
    server_name nhh-coffee.com www.nhh-coffee.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name nhh-coffee.com www.nhh-coffee.com;

    # SSL Configuration
    ssl_certificate /etc/letsencrypt/live/nhh-coffee.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/nhh-coffee.com/privkey.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;

    # Security Headers
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;

    # Gzip Compression
    gzip on;
    gzip_types text/plain text/css application/json application/javascript;
    gzip_min_length 1000;

    # API Routes
    location /api {
        proxy_pass http://api_upstream;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # Socket.io
    location /socket.io {
        proxy_pass http://api_upstream;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }

    # Next.js
    location / {
        proxy_pass http://nextjs_upstream;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }

    # Static files
    location /_next/static {
        proxy_pass http://nextjs_upstream;
        add_header Cache-Control "public, max-age=31536000, immutable";
    }
}
```

### 4.4 PM2 Configuration

```javascript
// ecosystem.config.js

module.exports = {
  apps: [
    {
      name: 'nhh-coffee-api',
      script: './server/dist/index.js',
      instances: 4,
      exec_mode: 'cluster',
      env: {
        NODE_ENV: 'production',
        PORT: 3001
      },
      error_file: './logs/api-error.log',
      out_file: './logs/api-out.log',
      log_date_format: 'YYYY-MM-DD HH:mm:ss Z',
      merge_logs: true,
      max_memory_restart: '1G',
      autorestart: true,
      watch: false
    },
    {
      name: 'nhh-coffee-web',
      script: 'npm',
      args: 'start',
      cwd: './client',
      instances: 2,
      exec_mode: 'cluster',
      env: {
        NODE_ENV: 'production',
        PORT: 3000
      },
      error_file: './logs/web-error.log',
      out_file: './logs/web-out.log',
      log_date_format: 'YYYY-MM-DD HH:mm:ss Z',
      merge_logs: true,
      max_memory_restart: '1G',
      autorestart: true,
      watch: false
    }
  ]
};
```

---

## 5. KIáº¾N TRÃšC Dá»® LIá»†U

### 5.1 MÃ´ hÃ¬nh dá»¯ liá»‡u

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE ARCHITECTURE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  CORE ENTITIES                                             â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  users â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€ orders â”€â”€â”€â”€â”€ order_items              â”‚ â”‚
â”‚  â”‚    â”‚         â”‚        â”‚                                    â”‚ â”‚
â”‚  â”‚    â”‚         â”‚        â””â”€â”€â”€â”€â”€ promotions                    â”‚ â”‚
â”‚  â”‚    â”‚         â”‚                                             â”‚ â”‚
â”‚  â”‚    â”‚         â”œâ”€â”€â”€â”€â”€ cart_items â”€â”€â”€â”€â”€ products â”€â”€â”¬         â”‚ â”‚
â”‚  â”‚    â”‚         â”‚                          â”‚       â”‚         â”‚ â”‚
â”‚  â”‚    â”‚         â”‚                          â”‚       â”‚         â”‚ â”‚
â”‚  â”‚    â”‚         â”œâ”€â”€â”€â”€â”€ wishlist â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚         â”‚ â”‚
â”‚  â”‚    â”‚         â”‚                                  â”‚         â”‚ â”‚
â”‚  â”‚    â”‚         â””â”€â”€â”€â”€â”€ reviews â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚
â”‚  â”‚    â”‚                   â”‚                                   â”‚ â”‚
â”‚  â”‚    â”‚                   â””â”€â”€â”€â”€â”€ review_images                â”‚ â”‚
â”‚  â”‚    â”‚                                                       â”‚ â”‚
â”‚  â”‚    â”œâ”€â”€â”€â”€â”€ notifications                                    â”‚ â”‚
â”‚  â”‚    â”‚                                                       â”‚ â”‚
â”‚  â”‚    â”œâ”€â”€â”€â”€â”€ push_subscriptions                              â”‚ â”‚
â”‚  â”‚    â”‚                                                       â”‚ â”‚
â”‚  â”‚    â”œâ”€â”€â”€â”€â”€ points_history                                  â”‚ â”‚
â”‚  â”‚    â”‚                                                       â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€ chat_sessions â”€â”€â”€â”€â”€ chat_messages               â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  products â”€â”€â”€â”€â”€ categories                                 â”‚ â”‚
â”‚  â”‚    â”‚                                                       â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€ stock_transactions                              â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  BUSINESS ENTITIES                                         â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  promotions â”€â”€â”€â”€â”€ promotion_usage                          â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  tables â”€â”€â”€â”€â”€ kitchen_items                                â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  shifts â”€â”€â”€â”€â”€ shift_swaps                                  â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  chatbot_knowledge                                         â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  product_questions                                         â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Chiáº¿n lÆ°á»£c Indexing

```sql
-- Performance Indexes

-- Users
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);
CREATE INDEX idx_users_tier ON users(tier);
CREATE INDEX idx_users_points ON users(points);

-- Products
CREATE INDEX idx_products_slug ON products(slug);
CREATE INDEX idx_products_category ON products(category_id);
CREATE INDEX idx_products_price ON products(price);
CREATE INDEX idx_products_stock ON products(stock);
CREATE INDEX idx_products_featured ON products(is_featured) WHERE is_featured = true;

-- Orders
CREATE INDEX idx_orders_user ON orders(user_id);
CREATE INDEX idx_orders_status ON orders(status);
CREATE INDEX idx_orders_created ON orders(created_at DESC);
CREATE INDEX idx_orders_user_status ON orders(user_id, status);
CREATE INDEX idx_orders_created_status ON orders(created_at DESC, status);

-- Cart
CREATE INDEX idx_cart_user ON cart_items(user_id);
CREATE INDEX idx_cart_product ON cart_items(product_id);
CREATE UNIQUE INDEX idx_cart_user_product ON cart_items(user_id, product_id);

-- Reviews
CREATE INDEX idx_reviews_product ON reviews(product_id);
CREATE INDEX idx_reviews_user ON reviews(user_id);
CREATE INDEX idx_reviews_rating ON reviews(rating);

-- Stock Transactions
CREATE INDEX idx_stock_product ON stock_transactions(product_id);
CREATE INDEX idx_stock_user ON stock_transactions(user_id);
CREATE INDEX idx_stock_created ON stock_transactions(created_at DESC);
CREATE INDEX idx_stock_type ON stock_transactions(type);

-- Notifications
CREATE INDEX idx_notifications_user_read ON notifications(user_id, is_read);
CREATE INDEX idx_notifications_created ON notifications(created_at DESC);

-- Chat
CREATE INDEX idx_chat_sessions_user ON chat_sessions(user_id);
CREATE INDEX idx_chat_sessions_staff ON chat_sessions(staff_id);
CREATE INDEX idx_chat_sessions_status ON chat_sessions(status);
CREATE INDEX idx_chat_messages_session ON chat_messages(session_id);
```

### 5.3 Chiáº¿n lÆ°á»£c Caching

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CACHING STRATEGY                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  CACHE LAYERS:                                                   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  L1: Memory Cache (In-process)                             â”‚ â”‚
â”‚  â”‚  - Fallback when Redis unavailable                         â”‚ â”‚
â”‚  â”‚  - TTL: 5-10 minutes                                       â”‚ â”‚
â”‚  â”‚  - Size: Limited by RAM                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  L2: Redis Cache (Distributed)                             â”‚ â”‚
â”‚  â”‚  - Primary cache layer                                     â”‚ â”‚
â”‚  â”‚  - TTL: 5-60 minutes                                       â”‚ â”‚
â”‚  â”‚  - Shared across instances                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  L3: Database (PostgreSQL)                                 â”‚ â”‚
â”‚  â”‚  - Source of truth                                         â”‚ â”‚
â”‚  â”‚  - Persistent storage                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  CACHED DATA:                                                    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Data Type               â”‚ TTL          â”‚ Invalidation     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Product List            â”‚ 5 minutes    â”‚ On update/delete â”‚ â”‚
â”‚  â”‚ Product Detail          â”‚ 10 minutes   â”‚ On update        â”‚ â”‚
â”‚  â”‚ Categories              â”‚ 1 hour       â”‚ On update        â”‚ â”‚
â”‚  â”‚ User Cart               â”‚ 5 minutes    â”‚ On change        â”‚ â”‚
â”‚  â”‚ Flash Sales             â”‚ 1 minute     â”‚ On update        â”‚ â”‚
â”‚  â”‚ User Session            â”‚ 7 days       â”‚ On logout        â”‚ â”‚
â”‚  â”‚ API Rate Limit          â”‚ 1 minute     â”‚ Auto expire      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  CACHE INVALIDATION STRATEGIES:                                 â”‚
â”‚                                                                  â”‚
â”‚  1. Time-based (TTL)                                            â”‚
â”‚     - Automatic expiration                                      â”‚
â”‚     - Suitable for rarely changed data                          â”‚
â”‚                                                                  â”‚
â”‚  2. Event-based                                                 â”‚
â”‚     - Invalidate on data change                                 â”‚
â”‚     - Suitable for frequently updated data                      â”‚
â”‚                                                                  â”‚
â”‚  3. Pattern-based                                               â”‚
â”‚     - Invalidate by key pattern                                 â”‚
â”‚     - Example: products:* when any product changes              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



---

## 6. KIáº¾N TRÃšC Báº¢O Máº¬T

### 6.1 Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AUTHENTICATION FLOW                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  REGISTRATION FLOW:                                              â”‚
â”‚                                                                  â”‚
â”‚  User                    Frontend                Backend         â”‚
â”‚   â”‚                         â”‚                      â”‚             â”‚
â”‚   â”‚  1. Enter info          â”‚                      â”‚             â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚             â”‚
â”‚   â”‚                         â”‚  2. POST /register   â”‚             â”‚
â”‚   â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚
â”‚   â”‚                         â”‚                      â”‚             â”‚
â”‚   â”‚                         â”‚  3. Validate input   â”‚             â”‚
â”‚   â”‚                         â”‚  4. Hash password    â”‚             â”‚
â”‚   â”‚                         â”‚  5. Generate OTP     â”‚             â”‚
â”‚   â”‚                         â”‚  6. Save pending     â”‚             â”‚
â”‚   â”‚                         â”‚  7. Send email       â”‚             â”‚
â”‚   â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚   â”‚  8. Check email         â”‚                      â”‚             â”‚
â”‚   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚             â”‚
â”‚   â”‚                         â”‚                      â”‚             â”‚
â”‚   â”‚  9. Enter OTP           â”‚                      â”‚             â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚             â”‚
â”‚   â”‚                         â”‚  10. POST /verify    â”‚             â”‚
â”‚   â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚
â”‚   â”‚                         â”‚                      â”‚             â”‚
â”‚   â”‚                         â”‚  11. Verify OTP      â”‚             â”‚
â”‚   â”‚                         â”‚  12. Create user     â”‚             â”‚
â”‚   â”‚                         â”‚  13. Generate JWT    â”‚             â”‚
â”‚   â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚   â”‚  14. Login success      â”‚                      â”‚             â”‚
â”‚   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚             â”‚
â”‚                                                                  â”‚
â”‚  LOGIN FLOW:                                                     â”‚
â”‚                                                                  â”‚
â”‚  User                    Frontend                Backend         â”‚
â”‚   â”‚                         â”‚                      â”‚             â”‚
â”‚   â”‚  1. Enter credentials   â”‚                      â”‚             â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚             â”‚
â”‚   â”‚                         â”‚  2. POST /login      â”‚             â”‚
â”‚   â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚
â”‚   â”‚                         â”‚                      â”‚             â”‚
â”‚   â”‚                         â”‚  3. Find user        â”‚             â”‚
â”‚   â”‚                         â”‚  4. Compare password â”‚             â”‚
â”‚   â”‚                         â”‚  5. Generate JWT     â”‚             â”‚
â”‚   â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚   â”‚  6. Store token         â”‚                      â”‚             â”‚
â”‚   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 JWT Token Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      JWT TOKEN STRUCTURE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Header:                                                         â”‚
â”‚  {                                                               â”‚
â”‚    "alg": "HS256",                                               â”‚
â”‚    "typ": "JWT"                                                  â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Payload:                                                        â”‚
â”‚  {                                                               â”‚
â”‚    "userId": "uuid",                                             â”‚
â”‚    "email": "user@example.com",                                  â”‚
â”‚    "role": "user|admin|sales|warehouse",                         â”‚
â”‚    "iat": 1234567890,  // Issued at                             â”‚
â”‚    "exp": 1234567890   // Expiration (7 days)                   â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Signature:                                                      â”‚
â”‚  HMACSHA256(                                                     â”‚
â”‚    base64UrlEncode(header) + "." +                               â”‚
â”‚    base64UrlEncode(payload),                                     â”‚
â”‚    JWT_SECRET                                                    â”‚
â”‚  )                                                               â”‚
â”‚                                                                  â”‚
â”‚  Token Lifecycle:                                                â”‚
â”‚  â”œâ”€ Generation: On login/register                                â”‚
â”‚  â”œâ”€ Storage: localStorage (client)                               â”‚
â”‚  â”œâ”€ Transmission: Authorization header                           â”‚
â”‚  â”œâ”€ Validation: Every protected request                          â”‚
â”‚  â””â”€ Expiration: 7 days                                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


### 6.3 Authorization Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AUTHORIZATION MATRIX                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Feature/Endpoint          â”‚ User â”‚ Sales â”‚ Warehouse â”‚ Admin  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Browse Products           â”‚  âœ“   â”‚   âœ“   â”‚     âœ“     â”‚   âœ“    â”‚
â”‚  View Product Detail       â”‚  âœ“   â”‚   âœ“   â”‚     âœ“     â”‚   âœ“    â”‚
â”‚  Add to Cart               â”‚  âœ“   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Place Order               â”‚  âœ“   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  View Own Orders           â”‚  âœ“   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Cancel Own Order          â”‚  âœ“   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Write Review              â”‚  âœ“   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Chat with Support         â”‚  âœ“   â”‚   âœ“   â”‚     âœ“     â”‚   âœ“    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POS Operations            â”‚  âœ—   â”‚   âœ“   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Table Management          â”‚  âœ—   â”‚   âœ“   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Kitchen Display           â”‚  âœ—   â”‚   âœ“   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  View All Orders           â”‚  âœ—   â”‚   âœ“   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Update Order Status       â”‚  âœ—   â”‚   âœ“   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Customer Chat             â”‚  âœ—   â”‚   âœ“   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Stock Management          â”‚  âœ—   â”‚   âœ—   â”‚     âœ“     â”‚   âœ“    â”‚
â”‚  Import/Export Stock       â”‚  âœ—   â”‚   âœ—   â”‚     âœ“     â”‚   âœ“    â”‚
â”‚  Stock Alerts              â”‚  âœ—   â”‚   âœ—   â”‚     âœ“     â”‚   âœ“    â”‚
â”‚  Inventory Reports         â”‚  âœ—   â”‚   âœ—   â”‚     âœ“     â”‚   âœ“    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Product Management        â”‚  âœ—   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Category Management       â”‚  âœ—   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  User Management           â”‚  âœ—   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Staff Management          â”‚  âœ—   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Promotion Management      â”‚  âœ—   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  System Settings           â”‚  âœ—   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Analytics & Reports       â”‚  âœ—   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  Backup & Restore          â”‚  âœ—   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚  AI Knowledge Base         â”‚  âœ—   â”‚   âœ—   â”‚     âœ—     â”‚   âœ“    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.4 Security Best Practices

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY BEST PRACTICES                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. PASSWORD SECURITY                                            â”‚
â”‚     â”œâ”€ Hashing: bcrypt (cost factor: 10)                        â”‚
â”‚     â”œâ”€ Minimum length: 8 characters                             â”‚
â”‚     â”œâ”€ Requirements: uppercase, lowercase, number               â”‚
â”‚     â”œâ”€ No password in logs                                      â”‚
â”‚     â””â”€ Password reset via OTP                                   â”‚
â”‚                                                                  â”‚
â”‚  2. INPUT VALIDATION                                             â”‚
â”‚     â”œâ”€ Server-side validation (Zod)                             â”‚
â”‚     â”œâ”€ Sanitization (remove XSS)                                â”‚
â”‚     â”œâ”€ SQL injection prevention (Prisma ORM)                    â”‚
â”‚     â”œâ”€ File upload validation                                   â”‚
â”‚     â””â”€ Rate limiting on sensitive endpoints                     â”‚
â”‚                                                                  â”‚
â”‚  3. AUTHENTICATION                                               â”‚
â”‚     â”œâ”€ JWT with secure secret                                   â”‚
â”‚     â”œâ”€ Token expiration (7 days)                                â”‚
â”‚     â”œâ”€ HTTPS only in production                                 â”‚
â”‚     â”œâ”€ Secure cookie flags                                      â”‚
â”‚     â””â”€ OTP verification (6 digits, 5 minutes)                   â”‚
â”‚                                                                  â”‚
â”‚  4. AUTHORIZATION                                                â”‚
â”‚     â”œâ”€ Role-based access control                                â”‚
â”‚     â”œâ”€ Principle of least privilege                             â”‚
â”‚     â”œâ”€ Resource ownership check                                 â”‚
â”‚     â””â”€ API endpoint protection                                  â”‚
â”‚                                                                  â”‚
â”‚  5. DATA PROTECTION                                              â”‚
â”‚     â”œâ”€ Sensitive data encryption                                â”‚
â”‚     â”œâ”€ HTTPS/TLS in production                                  â”‚
â”‚     â”œâ”€ Database connection encryption                           â”‚
â”‚     â”œâ”€ Environment variables for secrets                        â”‚
â”‚     â””â”€ Regular backups                                          â”‚
â”‚                                                                  â”‚
â”‚  6. API SECURITY                                                 â”‚
â”‚     â”œâ”€ CORS configuration                                       â”‚
â”‚     â”œâ”€ Rate limiting (100 req/15min)                            â”‚
â”‚     â”œâ”€ Request size limits                                      â”‚
â”‚     â”œâ”€ Security headers (Helmet)                                â”‚
â”‚     â””â”€ API versioning                                           â”‚
â”‚                                                                  â”‚
â”‚  7. ERROR HANDLING                                               â”‚
â”‚     â”œâ”€ No sensitive info in error messages                      â”‚
â”‚     â”œâ”€ Generic error messages to client                         â”‚
â”‚     â”œâ”€ Detailed logs server-side only                           â”‚
â”‚     â””â”€ Error monitoring                                         â”‚
â”‚                                                                  â”‚
â”‚  8. SESSION MANAGEMENT                                           â”‚
â”‚     â”œâ”€ Secure session storage                                   â”‚
â”‚     â”œâ”€ Session timeout                                          â”‚
â”‚     â”œâ”€ Logout functionality                                     â”‚
â”‚     â””â”€ Concurrent session handling                              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


---

## 7. KIáº¾N TRÃšC TÃCH Há»¢P

### 7.1 External Services Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  EXTERNAL SERVICES INTEGRATION                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. GOOGLE GEMINI AI                                       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Purpose: AI Chatbot, Customer Support                     â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Integration:                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ SDK: @google/generative-ai                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ Model: gemini-1.5-flash                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ API Key: Environment variable                         â”‚ â”‚
â”‚  â”‚  â””â”€ Rate Limit: 60 requests/minute                        â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Features:                                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ Product inquiry                                        â”‚ â”‚
â”‚  â”‚  â”œâ”€ Order tracking                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ General questions                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ Intent detection                                       â”‚ â”‚
â”‚  â”‚  â””â”€ Context-aware responses                               â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Flow:                                                     â”‚ â”‚
â”‚  â”‚  User â†’ Frontend â†’ Backend â†’ Gemini API â†’ Response        â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Error Handling:                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ API error â†’ Fallback to knowledge base                â”‚ â”‚
â”‚  â”‚  â”œâ”€ Rate limit â†’ Queue request                            â”‚ â”‚
â”‚  â”‚  â””â”€ Timeout â†’ Generic response                            â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. CLOUDINARY (Image Storage & CDN)                       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Purpose: Product images, User avatars, Review images      â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Integration:                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ SDK: cloudinary                                        â”‚ â”‚
â”‚  â”‚  â”œâ”€ Upload API                                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ Transformation API                                     â”‚ â”‚
â”‚  â”‚  â””â”€ CDN delivery                                           â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Features:                                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ Image upload                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ Auto optimization                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ Responsive images                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ Image transformation                                   â”‚ â”‚
â”‚  â”‚  â””â”€ CDN caching                                            â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Configuration:                                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ cloud_name: from env                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ api_key: from env                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ api_secret: from env                                   â”‚ â”‚
â”‚  â”‚  â””â”€ folder: nhh-coffee/                                    â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. EMAIL SERVICE (Nodemailer + SMTP)                      â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Purpose: OTP, Order confirmation, Notifications           â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Integration:                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ Library: nodemailer                                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ Transport: SMTP                                        â”‚ â”‚
â”‚  â”‚  â”œâ”€ Provider: Gmail / Custom SMTP                          â”‚ â”‚
â”‚  â”‚  â””â”€ Templates: HTML email templates                        â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Email Types:                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ OTP Verification                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ Password Reset                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ Order Confirmation                                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ Order Status Update                                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ Shipping Notification                                  â”‚ â”‚
â”‚  â”‚  â””â”€ Promotional emails                                     â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Configuration:                                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ host: smtp.gmail.com                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ port: 587                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ secure: false (STARTTLS)                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ auth: { user, pass }                                   â”‚ â”‚
â”‚  â”‚  â””â”€ from: "NHH Coffee <noreply@nhh-coffee.com>"           â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4. WEB PUSH NOTIFICATIONS                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Purpose: Real-time notifications to users                 â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Integration:                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ Library: web-push                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ Protocol: Web Push Protocol                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ VAPID keys: Generated                                  â”‚ â”‚
â”‚  â”‚  â””â”€ Service Worker: /sw.js                                 â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Notification Types:                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ Order status changed                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ New promotion                                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ Wishlist item on sale                                  â”‚ â”‚
â”‚  â”‚  â”œâ”€ Low stock alert (staff)                                â”‚ â”‚
â”‚  â”‚  â””â”€ New order (staff)                                      â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Flow:                                                     â”‚ â”‚
â”‚  â”‚  1. User grants permission                                 â”‚ â”‚
â”‚  â”‚  2. Subscribe to push service                              â”‚ â”‚
â”‚  â”‚  3. Save subscription to DB                                â”‚ â”‚
â”‚  â”‚  4. Send notification via web-push                         â”‚ â”‚
â”‚  â”‚  5. Service worker displays notification                   â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  5. PAYMENT GATEWAY (VietQR)                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Purpose: QR code payment                                  â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Integration:                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ API: VietQR API                                        â”‚ â”‚
â”‚  â”‚  â”œâ”€ Bank: Configured bank account                          â”‚ â”‚
â”‚  â”‚  â””â”€ QR Generation: Dynamic QR codes                        â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Payment Flow:                                             â”‚ â”‚
â”‚  â”‚  1. User selects QR payment                                â”‚ â”‚
â”‚  â”‚  2. Generate QR code with order info                       â”‚ â”‚
â”‚  â”‚  3. User scans and pays                                    â”‚ â”‚
â”‚  â”‚  4. Bank sends webhook (optional)                          â”‚ â”‚
â”‚  â”‚  5. Staff confirms payment                                 â”‚ â”‚
â”‚  â”‚  6. Order status updated                                   â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


---

## 8. THIáº¾T Káº¾ API

### 8.1 REST API Design Principles

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REST API DESIGN PRINCIPLES                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. RESOURCE-BASED URLs                                          â”‚
â”‚     â”œâ”€ Use nouns, not verbs                                     â”‚
â”‚     â”œâ”€ Plural for collections: /api/products                    â”‚
â”‚     â”œâ”€ Singular for specific: /api/products/:id                 â”‚
â”‚     â””â”€ Nested resources: /api/orders/:id/items                  â”‚
â”‚                                                                  â”‚
â”‚  2. HTTP METHODS                                                 â”‚
â”‚     â”œâ”€ GET: Retrieve resource(s)                                â”‚
â”‚     â”œâ”€ POST: Create new resource                                â”‚
â”‚     â”œâ”€ PUT: Update entire resource                              â”‚
â”‚     â”œâ”€ PATCH: Partial update                                    â”‚
â”‚     â””â”€ DELETE: Remove resource                                  â”‚
â”‚                                                                  â”‚
â”‚  3. STATUS CODES                                                 â”‚
â”‚     â”œâ”€ 200 OK: Success                                          â”‚
â”‚     â”œâ”€ 201 Created: Resource created                            â”‚
â”‚     â”œâ”€ 204 No Content: Success, no body                         â”‚
â”‚     â”œâ”€ 400 Bad Request: Invalid input                           â”‚
â”‚     â”œâ”€ 401 Unauthorized: Not authenticated                      â”‚
â”‚     â”œâ”€ 403 Forbidden: Not authorized                            â”‚
â”‚     â”œâ”€ 404 Not Found: Resource not found                        â”‚
â”‚     â”œâ”€ 429 Too Many Requests: Rate limit                        â”‚
â”‚     â””â”€ 500 Internal Server Error: Server error                  â”‚
â”‚                                                                  â”‚
â”‚  4. RESPONSE FORMAT                                              â”‚
â”‚     Success:                                                     â”‚
â”‚     {                                                            â”‚
â”‚       "success": true,                                           â”‚
â”‚       "data": { ... },                                           â”‚
â”‚       "message": "Operation successful"                          â”‚
â”‚     }                                                            â”‚
â”‚                                                                  â”‚
â”‚     Error:                                                       â”‚
â”‚     {                                                            â”‚
â”‚       "success": false,                                          â”‚
â”‚       "error": "Error message",                                  â”‚
â”‚       "code": "ERROR_CODE"                                       â”‚
â”‚     }                                                            â”‚
â”‚                                                                  â”‚
â”‚  5. PAGINATION                                                   â”‚
â”‚     Query: ?page=1&limit=20                                      â”‚
â”‚     Response:                                                    â”‚
â”‚     {                                                            â”‚
â”‚       "success": true,                                           â”‚
â”‚       "data": [...],                                             â”‚
â”‚       "pagination": {                                            â”‚
â”‚         "page": 1,                                               â”‚
â”‚         "limit": 20,                                             â”‚
â”‚         "total": 100,                                            â”‚
â”‚         "totalPages": 5                                          â”‚
â”‚       }                                                          â”‚
â”‚     }                                                            â”‚
â”‚                                                                  â”‚
â”‚  6. FILTERING & SORTING                                          â”‚
â”‚     â”œâ”€ Filter: ?category=coffee&minPrice=50000                  â”‚
â”‚     â”œâ”€ Sort: ?sort=price_asc                                    â”‚
â”‚     â”œâ”€ Search: ?q=cappuccino                                    â”‚
â”‚     â””â”€ Multiple: ?category=coffee&sort=price_desc&page=2        â”‚
â”‚                                                                  â”‚
â”‚  7. VERSIONING                                                   â”‚
â”‚     â”œâ”€ URL: /api/v1/products                                    â”‚
â”‚     â””â”€ Future: /api/v2/products                                 â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 API Endpoints Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API ENDPOINTS OVERVIEW                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  AUTHENTICATION (/api/auth)                                      â”‚
â”‚  â”œâ”€ POST   /register              Register new user             â”‚
â”‚  â”œâ”€ POST   /verify-otp            Verify OTP                    â”‚
â”‚  â”œâ”€ POST   /login                 Login                         â”‚
â”‚  â”œâ”€ POST   /logout                Logout                        â”‚
â”‚  â”œâ”€ GET    /me                    Get current user              â”‚
â”‚  â”œâ”€ POST   /forgot-password       Request password reset        â”‚
â”‚  â””â”€ POST   /reset-password        Reset password                â”‚
â”‚                                                                  â”‚
â”‚  PRODUCTS (/api/products)                                        â”‚
â”‚  â”œâ”€ GET    /                      List products (paginated)     â”‚
â”‚  â”œâ”€ GET    /:slug                 Get product by slug           â”‚
â”‚  â”œâ”€ GET    /search                Search products               â”‚
â”‚  â”œâ”€ POST   /                      Create product (Admin)        â”‚
â”‚  â”œâ”€ PUT    /:id                   Update product (Admin)        â”‚
â”‚  â””â”€ DELETE /:id                   Delete product (Admin)        â”‚
â”‚                                                                  â”‚
â”‚  CATEGORIES (/api/categories)                                    â”‚
â”‚  â”œâ”€ GET    /                      List categories               â”‚
â”‚  â”œâ”€ GET    /:slug                 Get category                  â”‚
â”‚  â”œâ”€ GET    /:slug/products        Get category products         â”‚
â”‚  â”œâ”€ POST   /                      Create category (Admin)       â”‚
â”‚  â”œâ”€ PUT    /:id                   Update category (Admin)       â”‚
â”‚  â””â”€ DELETE /:id                   Delete category (Admin)       â”‚
â”‚                                                                  â”‚
â”‚  CART (/api/cart)                                                â”‚
â”‚  â”œâ”€ GET    /                      Get user cart                 â”‚
â”‚  â”œâ”€ POST   /items                 Add item to cart              â”‚
â”‚  â”œâ”€ PUT    /items/:id             Update cart item              â”‚
â”‚  â”œâ”€ DELETE /items/:id             Remove cart item              â”‚
â”‚  â””â”€ DELETE /                      Clear cart                    â”‚
â”‚                                                                  â”‚
â”‚  ORDERS (/api/orders)                                            â”‚
â”‚  â”œâ”€ GET    /                      List user orders              â”‚
â”‚  â”œâ”€ GET    /:id                   Get order details             â”‚
â”‚  â”œâ”€ POST   /                      Create order                  â”‚
â”‚  â”œâ”€ POST   /:id/cancel            Cancel order                  â”‚
â”‚  â”œâ”€ PUT    /:id/status            Update status (Staff)         â”‚
â”‚  â””â”€ GET    /staff/all             List all orders (Staff)       â”‚
â”‚                                                                  â”‚
â”‚  REVIEWS (/api/reviews)                                          â”‚
â”‚  â”œâ”€ GET    /product/:id           Get product reviews           â”‚
â”‚  â”œâ”€ POST   /                      Create review                 â”‚
â”‚  â”œâ”€ PUT    /:id                   Update review                 â”‚
â”‚  â””â”€ DELETE /:id                   Delete review                 â”‚
â”‚                                                                  â”‚
â”‚  WISHLIST (/api/wishlist)                                        â”‚
â”‚  â”œâ”€ GET    /                      Get user wishlist             â”‚
â”‚  â”œâ”€ POST   /                      Add to wishlist               â”‚
â”‚  â””â”€ DELETE /:productId            Remove from wishlist          â”‚
â”‚                                                                  â”‚
â”‚  CHATBOT (/api/chatbot)                                          â”‚
â”‚  â”œâ”€ POST   /message               Send message to AI            â”‚
â”‚  â”œâ”€ GET    /history               Get chat history              â”‚
â”‚  â”œâ”€ POST   /feedback              Submit feedback               â”‚
â”‚  â””â”€ GET    /knowledge             Get knowledge base (Admin)    â”‚
â”‚                                                                  â”‚
â”‚  POS (/api/pos) - Staff only                                     â”‚
â”‚  â”œâ”€ POST   /orders                Create POS order              â”‚
â”‚  â”œâ”€ GET    /orders                List POS orders               â”‚
â”‚  â””â”€ GET    /history               POS history                   â”‚
â”‚                                                                  â”‚
â”‚  TABLES (/api/tables) - Staff only                               â”‚
â”‚  â”œâ”€ GET    /                      List tables                   â”‚
â”‚  â”œâ”€ POST   /                      Create table                  â”‚
â”‚  â”œâ”€ PUT    /:id                   Update table                  â”‚
â”‚  â”œâ”€ POST   /:id/reserve           Reserve table                 â”‚
â”‚  â””â”€ POST   /:id/release           Release table                 â”‚
â”‚                                                                  â”‚
â”‚  KITCHEN (/api/kitchen) - Staff only                             â”‚
â”‚  â”œâ”€ GET    /items                 Get kitchen queue             â”‚
â”‚  â”œâ”€ PUT    /items/:id/status      Update item status            â”‚
â”‚  â””â”€ GET    /items/history         Kitchen history               â”‚
â”‚                                                                  â”‚
â”‚  STOCK (/api/stock) - Warehouse/Admin                            â”‚
â”‚  â”œâ”€ GET    /                      List stock                    â”‚
â”‚  â”œâ”€ POST   /import                Import stock                  â”‚
â”‚  â”œâ”€ POST   /export                Export stock                  â”‚
â”‚  â”œâ”€ GET    /transactions          Stock transactions            â”‚
â”‚  â””â”€ GET    /alerts                Low stock alerts              â”‚
â”‚                                                                  â”‚
â”‚  REPORTS (/api/reports) - Admin                                  â”‚
â”‚  â”œâ”€ GET    /revenue               Revenue report                â”‚
â”‚  â”œâ”€ GET    /orders                Order statistics              â”‚
â”‚  â”œâ”€ GET    /products              Product performance           â”‚
â”‚  â””â”€ GET    /customers             Customer analytics            â”‚
â”‚                                                                  â”‚
â”‚  NOTIFICATIONS (/api/notifications)                              â”‚
â”‚  â”œâ”€ GET    /                      List notifications            â”‚
â”‚  â”œâ”€ PUT    /:id/read              Mark as read                  â”‚
â”‚  â”œâ”€ PUT    /read-all              Mark all as read              â”‚
â”‚  â””â”€ POST   /subscribe             Subscribe to push             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


---

## 9. THIáº¾T Káº¾ REAL-TIME

### 9.1 Socket.io Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SOCKET.IO ARCHITECTURE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  CONNECTION FLOW:                                                â”‚
â”‚                                                                  â”‚
â”‚  Client                    Socket.io Server                      â”‚
â”‚   â”‚                              â”‚                               â”‚
â”‚   â”‚  1. Connect with JWT         â”‚                               â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                               â”‚
â”‚   â”‚                              â”‚  2. Verify JWT                â”‚
â”‚   â”‚                              â”‚  3. Extract user info         â”‚
â”‚   â”‚                              â”‚  4. Store socket mapping      â”‚
â”‚   â”‚  5. Connection success       â”‚                               â”‚
â”‚   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
â”‚   â”‚                              â”‚                               â”‚
â”‚   â”‚  6. Join rooms               â”‚                               â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                               â”‚
â”‚   â”‚                              â”‚  7. Add to room               â”‚
â”‚   â”‚  8. Room joined              â”‚                               â”‚
â”‚   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
â”‚                                                                  â”‚
â”‚  ROOM STRUCTURE:                                                 â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  user:{userId}                                             â”‚ â”‚
â”‚  â”‚  - Personal room for each user                             â”‚ â”‚
â”‚  â”‚  - Notifications, order updates                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  staff                                                     â”‚ â”‚
â”‚  â”‚  - All staff members                                       â”‚ â”‚
â”‚  â”‚  - New orders, alerts                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  kitchen                                                   â”‚ â”‚
â”‚  â”‚  - Kitchen staff                                           â”‚ â”‚
â”‚  â”‚  - New items, status updates                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  chat:{sessionId}                                          â”‚ â”‚
â”‚  â”‚  - Chat session room                                       â”‚ â”‚
â”‚  â”‚  - User and assigned staff                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  table:{tableId}                                           â”‚ â”‚
â”‚  â”‚  - Table-specific room                                     â”‚ â”‚
â”‚  â”‚  - Table status, orders                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 Real-time Events

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      REAL-TIME EVENTS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ORDER EVENTS:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  order:new                                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When new order created                        â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: staff room                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { orderId, total, items, customer }             â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Notify staff, play sound                       â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  order:status_changed                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When order status updated                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: user:{userId} room                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { orderId, status, message }                    â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Update UI, show notification                   â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  order:cancelled                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When order cancelled                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: staff room + user room                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { orderId, reason }                             â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Update order list                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  KITCHEN EVENTS:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  kitchen:new_item                                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When new item added to kitchen queue          â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: kitchen room                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { itemId, productName, quantity, table }        â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Add to kitchen display, play sound             â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  kitchen:item_ready                                        â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When item preparation completed               â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: staff room                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { itemId, table, productName }                  â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Notify server staff                            â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  kitchen:item_cancelled                                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When item cancelled                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: kitchen room                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { itemId, reason }                              â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Remove from queue                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  TABLE EVENTS:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  table:status_changed                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When table status changes                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: staff room                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { tableId, status, customer }                   â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Update table view                              â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  table:order_added                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When order added to table                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: table:{tableId} room                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { tableId, orderId, items }                     â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Update table order list                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  CHAT EVENTS:                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  chat:message                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When message sent                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: chat:{sessionId} room                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { messageId, content, sender, timestamp }       â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Display message                                â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  chat:typing                                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When user typing                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: chat:{sessionId} room                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { userId, isTyping }                            â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Show typing indicator                          â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  chat:session_assigned                                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When staff assigned to chat                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: user room + staff room                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { sessionId, staffName }                        â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Update chat UI                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  NOTIFICATION EVENTS:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  notification:new                                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When new notification created                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: user:{userId} room                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { id, type, title, message, data }              â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Show notification, update bell icon            â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  stock:alert                                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ Emitted: When stock below threshold                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ To: staff room (warehouse role)                        â”‚ â”‚
â”‚  â”‚  â”œâ”€ Data: { productId, productName, stock, threshold }    â”‚ â”‚
â”‚  â”‚  â””â”€ Action: Show alert                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


---

## 10. CHIáº¾N LÆ¯á»¢C Má» Rá»˜NG

### 10.1 Horizontal Scaling

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      HORIZONTAL SCALING                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  CURRENT (Single Server):                                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  VPS Server                                                â”‚ â”‚
â”‚  â”‚  â”œâ”€ Nginx                                                  â”‚ â”‚
â”‚  â”‚  â”œâ”€ Next.js (2 instances)                                  â”‚ â”‚
â”‚  â”‚  â”œâ”€ Express API (4 instances)                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ PostgreSQL                                             â”‚ â”‚
â”‚  â”‚  â””â”€ Redis                                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  SCALED (Multiple Servers):                                      â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Load Balancer (Nginx / HAProxy)                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                       â”‚                              â”‚
â”‚           â–¼                       â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  App Server 1   â”‚     â”‚  App Server 2   â”‚                   â”‚
â”‚  â”‚  â”œâ”€ Next.js     â”‚     â”‚  â”œâ”€ Next.js     â”‚                   â”‚
â”‚  â”‚  â””â”€ Express API â”‚     â”‚  â””â”€ Express API â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚           â”‚                       â”‚                              â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Database Cluster                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚ â”‚
â”‚  â”‚  â”‚  PostgreSQL  â”‚â”€â”€â”€â”€>â”‚  PostgreSQL  â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚  (Master)    â”‚     â”‚  (Replica)   â”‚                    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Redis Cluster                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚ â”‚
â”‚  â”‚  â”‚  Redis       â”‚â”€â”€â”€â”€>â”‚  Redis       â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚  (Master)    â”‚     â”‚  (Replica)   â”‚                    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  BENEFITS:                                                       â”‚
â”‚  â”œâ”€ Higher availability (99.9% uptime)                          â”‚
â”‚  â”œâ”€ Better performance (load distribution)                      â”‚
â”‚  â”œâ”€ Fault tolerance (server failure)                            â”‚
â”‚  â””â”€ Easy to add more servers                                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 Vertical Scaling

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       VERTICAL SCALING                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  CURRENT SPECS:                                                  â”‚
â”‚  â”œâ”€ CPU: 4 cores                                                â”‚
â”‚  â”œâ”€ RAM: 8GB                                                    â”‚
â”‚  â”œâ”€ Storage: 100GB SSD                                          â”‚
â”‚  â””â”€ Bandwidth: 1TB/month                                        â”‚
â”‚                                                                  â”‚
â”‚  UPGRADE PATH:                                                   â”‚
â”‚                                                                  â”‚
â”‚  Stage 1 (1,000 users):                                          â”‚
â”‚  â”œâ”€ CPU: 4 cores                                                â”‚
â”‚  â”œâ”€ RAM: 8GB                                                    â”‚
â”‚  â”œâ”€ Storage: 100GB SSD                                          â”‚
â”‚  â””â”€ Cost: ~$40/month                                            â”‚
â”‚                                                                  â”‚
â”‚  Stage 2 (5,000 users):                                          â”‚
â”‚  â”œâ”€ CPU: 8 cores                                                â”‚
â”‚  â”œâ”€ RAM: 16GB                                                   â”‚
â”‚  â”œâ”€ Storage: 200GB SSD                                          â”‚
â”‚  â””â”€ Cost: ~$80/month                                            â”‚
â”‚                                                                  â”‚
â”‚  Stage 3 (10,000+ users):                                        â”‚
â”‚  â”œâ”€ CPU: 16 cores                                               â”‚
â”‚  â”œâ”€ RAM: 32GB                                                   â”‚
â”‚  â”œâ”€ Storage: 500GB SSD                                          â”‚
â”‚  â””â”€ Cost: ~$160/month                                           â”‚
â”‚                                                                  â”‚
â”‚  BENEFITS:                                                       â”‚
â”‚  â”œâ”€ Simple to implement                                         â”‚
â”‚  â”œâ”€ No code changes needed                                      â”‚
â”‚  â”œâ”€ Immediate performance boost                                 â”‚
â”‚  â””â”€ Good for initial growth                                     â”‚
â”‚                                                                  â”‚
â”‚  LIMITATIONS:                                                    â”‚
â”‚  â”œâ”€ Single point of failure                                     â”‚
â”‚  â”œâ”€ Hardware limits                                             â”‚
â”‚  â”œâ”€ Downtime during upgrade                                     â”‚
â”‚  â””â”€ Cost increases exponentially                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.3 Performance Optimization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PERFORMANCE OPTIMIZATION                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. DATABASE OPTIMIZATION                                        â”‚
â”‚     â”œâ”€ Indexing strategy (see section 5.2)                      â”‚
â”‚     â”œâ”€ Query optimization                                       â”‚
â”‚     â”œâ”€ Connection pooling (max: 20)                             â”‚
â”‚     â”œâ”€ Read replicas for heavy reads                            â”‚
â”‚     â””â”€ Partitioning for large tables                            â”‚
â”‚                                                                  â”‚
â”‚  2. CACHING STRATEGY                                             â”‚
â”‚     â”œâ”€ Redis for frequently accessed data                       â”‚
â”‚     â”œâ”€ Memory cache fallback                                    â”‚
â”‚     â”œâ”€ CDN for static assets                                    â”‚
â”‚     â”œâ”€ Browser caching headers                                  â”‚
â”‚     â””â”€ API response caching                                     â”‚
â”‚                                                                  â”‚
â”‚  3. CODE OPTIMIZATION                                            â”‚
â”‚     â”œâ”€ Lazy loading components                                  â”‚
â”‚     â”œâ”€ Code splitting (Next.js)                                 â”‚
â”‚     â”œâ”€ Image optimization (Next/Image)                          â”‚
â”‚     â”œâ”€ Minimize bundle size                                     â”‚
â”‚     â””â”€ Tree shaking unused code                                 â”‚
â”‚                                                                  â”‚
â”‚  4. API OPTIMIZATION                                             â”‚
â”‚     â”œâ”€ Pagination for large datasets                            â”‚
â”‚     â”œâ”€ Field selection (GraphQL-style)                          â”‚
â”‚     â”œâ”€ Batch requests                                           â”‚
â”‚     â”œâ”€ Compression (gzip)                                       â”‚
â”‚     â””â”€ Rate limiting                                            â”‚
â”‚                                                                  â”‚
â”‚  5. FRONTEND OPTIMIZATION                                        â”‚
â”‚     â”œâ”€ SSR for initial load                                     â”‚
â”‚     â”œâ”€ ISR for static pages                                     â”‚
â”‚     â”œâ”€ Prefetching links                                        â”‚
â”‚     â”œâ”€ Optimistic UI updates                                    â”‚
â”‚     â””â”€ Virtual scrolling for long lists                         â”‚
â”‚                                                                  â”‚
â”‚  6. MONITORING & PROFILING                                       â”‚
â”‚     â”œâ”€ Application Performance Monitoring (APM)                 â”‚
â”‚     â”œâ”€ Database query profiling                                 â”‚
â”‚     â”œâ”€ Error tracking (Sentry)                                  â”‚
â”‚     â”œâ”€ Real User Monitoring (RUM)                               â”‚
â”‚     â””â”€ Server metrics (CPU, RAM, Disk)                          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.4 Monitoring & Logging

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MONITORING & LOGGING                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  APPLICATION MONITORING:                                         â”‚
â”‚  â”œâ”€ PM2 Monitoring                                              â”‚
â”‚  â”‚  â”œâ”€ Process status                                          â”‚
â”‚  â”‚  â”œâ”€ CPU & Memory usage                                      â”‚
â”‚  â”‚  â”œâ”€ Restart count                                           â”‚
â”‚  â”‚  â””â”€ Error logs                                              â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€ Custom Metrics                                              â”‚
â”‚  â”‚  â”œâ”€ Request count                                           â”‚
â”‚  â”‚  â”œâ”€ Response time                                           â”‚
â”‚  â”‚  â”œâ”€ Error rate                                              â”‚
â”‚  â”‚  â””â”€ Active users                                            â”‚
â”‚  â”‚                                                              â”‚
â”‚  â””â”€ Health Checks                                               â”‚
â”‚     â”œâ”€ /api/health (API status)                                â”‚
â”‚     â”œâ”€ Database connection                                      â”‚
â”‚     â”œâ”€ Redis connection                                         â”‚
â”‚     â””â”€ External services                                        â”‚
â”‚                                                                  â”‚
â”‚  LOGGING STRATEGY:                                               â”‚
â”‚  â”œâ”€ Log Levels:                                                 â”‚
â”‚  â”‚  â”œâ”€ ERROR: Critical errors                                  â”‚
â”‚  â”‚  â”œâ”€ WARN: Warnings                                          â”‚
â”‚  â”‚  â”œâ”€ INFO: Important events                                  â”‚
â”‚  â”‚  â””â”€ DEBUG: Detailed info (dev only)                         â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€ Log Files:                                                  â”‚
â”‚  â”‚  â”œâ”€ api-error.log                                           â”‚
â”‚  â”‚  â”œâ”€ api-out.log                                             â”‚
â”‚  â”‚  â”œâ”€ web-error.log                                           â”‚
â”‚  â”‚  â””â”€ web-out.log                                             â”‚
â”‚  â”‚                                                              â”‚
â”‚  â””â”€ Log Rotation:                                               â”‚
â”‚     â”œâ”€ Daily rotation                                           â”‚
â”‚     â”œâ”€ Keep 7 days                                              â”‚
â”‚     â””â”€ Compress old logs                                        â”‚
â”‚                                                                  â”‚
â”‚  ALERTS:                                                         â”‚
â”‚  â”œâ”€ Server down                                                 â”‚
â”‚  â”œâ”€ High error rate (>5%)                                       â”‚
â”‚  â”œâ”€ High response time (>2s)                                    â”‚
â”‚  â”œâ”€ Low disk space (<10%)                                       â”‚
â”‚  â”œâ”€ High CPU usage (>80%)                                       â”‚
â”‚  â””â”€ Database connection issues                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Káº¾T LUáº¬N

TÃ i liá»‡u nÃ y trÃ¬nh bÃ y chi tiáº¿t kiáº¿n trÃºc há»‡ thá»‘ng NHH-Coffee, bao gá»“m:

1. **Kiáº¿n trÃºc tá»•ng thá»ƒ**: Client-Server vá»›i phÃ¢n lá»›p rÃµ rÃ ng
2. **Kiáº¿n trÃºc triá»ƒn khai**: Development vÃ  Production environments
3. **Kiáº¿n trÃºc dá»¯ liá»‡u**: Database design, indexing, caching
4. **Kiáº¿n trÃºc báº£o máº­t**: Authentication, Authorization, Security best practices
5. **Kiáº¿n trÃºc tÃ­ch há»£p**: External services (Gemini AI, Cloudinary, Email, Push)
6. **Thiáº¿t káº¿ API**: RESTful API vá»›i 50+ endpoints
7. **Thiáº¿t káº¿ Real-time**: Socket.io vá»›i 20+ events
8. **Chiáº¿n lÆ°á»£c má»Ÿ rá»™ng**: Horizontal/Vertical scaling, Performance optimization

Há»‡ thá»‘ng Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ:
- **Dá»… báº£o trÃ¬**: Code rÃµ rÃ ng, tÃ¡ch biá»‡t trÃ¡ch nhiá»‡m
- **Dá»… má»Ÿ rá»™ng**: CÃ³ thá»ƒ scale theo nhu cáº§u
- **Báº£o máº­t cao**: Authentication, Authorization, Input validation
- **Hiá»‡u suáº¥t tá»‘t**: Caching, Indexing, Optimization
- **Sáºµn sÃ ng production**: Deployment strategy, Monitoring, Logging

---

**TÃ i liá»‡u Ä‘Æ°á»£c táº¡o cho Ä‘á»“ Ã¡n tá»‘t nghiá»‡p**  
**Há»‡ thá»‘ng: NHH-Coffee E-commerce & POS**  
**NgÃ y cáº­p nháº­t: 2026-01-30**
